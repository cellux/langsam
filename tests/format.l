(assert (= (format "%s:%s" "foo" 523) "foo:523"))
(assert (= (format "%r" "foo") "\"foo\""))
(assert (= (format "%d" 523) "523"))
(assert (= (format "%f" 1.5) "1.500000"))
(assert (= (format "%d:%f" -7 2.25) "-7:2.250000"))
(assert (= (format "100%% done") "100% done"))

(assert (throws? '(format . "missing format argument for %s")
                 (format "%s=%s" "x")))
(assert (throws? '(format . "missing format argument for %d")
                 (format "%d")))
(assert (throws? '(format . "missing format argument for %f")
                 (format "%f")))
(assert (throws? '(format . "format argument for %d is String, expected Integer")
                 (format "%d" "1")))
(assert (throws? '(format . "format argument for %f is Integer, expected Float")
                 (format "%f" 1)))
(assert (throws? '(format . "too many format arguments")
                 (format "ok" 1)))
(assert (throws? '(format . "unsupported format specifier: %q")
                 (format "%q" 1)))
(assert (throws? '(format . "dangling % at end of format string")
                 (format "x%")))
(assert (throws? '(type . "argument fmt is Integer, expected String")
                 (format 1)))
